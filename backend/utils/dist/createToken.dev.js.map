{"version":3,"sources":["createToken.js"],"names":["jwt","require","signToken","id","sign","process","env","JWT_SECRET","expiresIn","JWT_EXPIRES_IN","createToken","user","userStatus","req","res","token","_id","cookie","expires","Date","now","JWT_COOKIE_EXPIRES_IN","httpOnly","secure","headers","sameSite","credential","password","undefined","status","json","module","exports"],"mappings":";;AAAA,IAAMA,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAnB;;AAEA,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAACC,EAAD,EAAQ;AACxB,SAAOH,GAAG,CAACI,IAAJ,CAAS;AAAED,IAAAA,EAAE,EAAFA;AAAF,GAAT,EAAiBE,OAAO,CAACC,GAAR,CAAYC,UAA7B,EAAyC;AAC9CC,IAAAA,SAAS,EAAEH,OAAO,CAACC,GAAR,CAAYG;AADuB,GAAzC,CAAP;AAGD,CAJD;;AAMA,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAACC,IAAD,EAAOC,UAAP,EAAmBC,GAAnB,EAAwBC,GAAxB,EAAgC;AAClD,MAAMC,KAAK,GAAGb,SAAS,CAACS,IAAI,CAACK,GAAN,CAAvB;AAEAF,EAAAA,GAAG,CAACG,MAAJ,CAAW,KAAX,EAAkBF,KAAlB,EAAyB;AACvBG,IAAAA,OAAO,EAAE,IAAIC,IAAJ,CACPA,IAAI,CAACC,GAAL,KAAaf,OAAO,CAACC,GAAR,CAAYe,qBAAZ,GAAoC,EAApC,GAAyC,EAAzC,GAA8C,EAA9C,GAAmD,IADzD,CADc;AAIvBC,IAAAA,QAAQ,EAAE,IAJa;AAKvBC,IAAAA,MAAM,EAAE,QAAQV,GAAG,CAACW,OAAJ,CAAY,mBAAZ,MAAqC,OAL9B;AAMvBC,IAAAA,QAAQ,EAAE,MANa;AAOvBC,IAAAA,UAAU,EAAE;AAPW,GAAzB;AAUAf,EAAAA,IAAI,CAACgB,QAAL,GAAgBC,SAAhB;AAEAd,EAAAA,GAAG,CAACe,MAAJ,CAAWjB,UAAX,EAAuBkB,IAAvB,CAA4B;AAC1BD,IAAAA,MAAM,EAAE,SADkB;AAE1Bd,IAAAA,KAAK,EAALA;AAF0B,GAA5B;AAID,CAnBD;;AAqBAgB,MAAM,CAACC,OAAP,GAAiBtB,WAAjB","sourcesContent":["const jwt = require('jsonwebtoken');\r\n\r\nconst signToken = (id) => {\r\n  return jwt.sign({ id }, process.env.JWT_SECRET, {\r\n    expiresIn: process.env.JWT_EXPIRES_IN,\r\n  });\r\n};\r\n\r\nconst createToken = (user, userStatus, req, res) => {\r\n  const token = signToken(user._id);\r\n\r\n  res.cookie('jwt', token, {\r\n    expires: new Date(\r\n      Date.now() + process.env.JWT_COOKIE_EXPIRES_IN * 24 * 60 * 60 * 1000\r\n    ),\r\n    httpOnly: true,\r\n    secure: true || req.headers['x-forwarded-proto'] === 'https',\r\n    sameSite: 'none',\r\n    credential: true,\r\n  });\r\n\r\n  user.password = undefined;\r\n\r\n  res.status(userStatus).json({\r\n    status: 'success',\r\n    token,\r\n  });\r\n};\r\n\r\nmodule.exports = createToken;\r\n"],"file":"createToken.dev.js"}