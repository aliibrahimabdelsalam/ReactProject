{"version":3,"sources":["multer.js"],"names":["multer","require","fs","existsSync","mkdirSync","storage","diskStorage","destination","req","file","cb","filename","replace","originalname","mimetype","Date","toISOString","multerFilter","upload","fileFilter","module","exports"],"mappings":"aAAA,IAAMA,OAASC,QAAQ,UACjBC,GAAKD,QAAQ,MADbD,SAASC,QAAQ,qBACjBC,GAAEC,WAAW,YAIjBD,GAAGE,UAAU,WAEf,IAAMC,QAAUL,OAAOM,YAAY,CAHnCC,YAAQJ,SAAWK,EAAnBC,EAA+BC,GAC3BA,EAACN,KAAAA,YAMHO,SAAU,SAAUH,EAAKC,EAAMC,GAJ3BL,EAAAA,MAAO,IAAGL,MAAOM,cAAYM,QAAA,KAAA,KAAAH,EAAAI,iBAIjCF,aAAU,SAAAH,EAAAC,EAAAC,GACND,EAAAK,SAAWC,WAAOC,UACrBN,EAAA,MAAA,GAOCA,EAJEO,IAAAA,SAAe,kDAAmB,MAClCR,IADNS,OAAAlB,OAAA,CAYEK,QAASA,QADXc,WAAenB,eAAOoB,OAAtBC,QAAAH","file":"multer.min.js","sourcesContent":["const multer = require('multer');\r\nconst fs = require('fs');\r\nconst AppError = require('../utils/appError');\r\n\r\nif (!fs.existsSync('./media')) {\r\n  fs.mkdirSync('./media');\r\n}\r\nconst storage = multer.diskStorage({\r\n  destination: function (req, file, cb) {\r\n    cb(null, './media');\r\n  },\r\n  filename: function (req, file, cb) {\r\n    cb(null, new Date().toISOString().replace(/:/g, '.') + file.originalname);\r\n  },\r\n});\r\n\r\nconst multerFilter = (req, file, cb) => {\r\n  if (file.mimetype.startsWith('image/')) {\r\n    cb(null, true);\r\n  } else {\r\n    cb(\r\n      new AppError('File type not supported. Only image is allowed.', 401),\r\n      false\r\n    );\r\n  }\r\n};\r\n\r\nconst upload = multer({\r\n  storage: storage,\r\n  fileFilter: multerFilter,\r\n});\r\n\r\nmodule.exports = upload;\r\n"]}